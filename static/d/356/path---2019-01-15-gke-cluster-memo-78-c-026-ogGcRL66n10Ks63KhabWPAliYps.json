{"data":{"markdownRemark":{"html":"<p><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msup><mi>a</mi><mn>2</mn></msup><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup><mo>=</mo><msup><mi>c</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">a^2 + b^2 = c^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.897438em;vertical-align:-0.08333em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></p>\n<p>f1-micro インスタンスは 3 個以上でないと GKE クラスタが作れないが、<br>\n一度クラスタを作成してからインスタンスグループをスケーリングすることで一個でのクラスタに変更できる。(<a href=\"https://snyke.net/post/kubernetes-playground/\">参考</a>)\nf1-micro はメモリが 0.6GB しかないので、自動でデプロイされるコンテナできちきちな状況。<br>\nログのコンテナとか色々無効にすれば空きはでるものの (<a href=\"https://qiita.com/apstndb/items/1c3f8ea026ed6b27e357\">参考</a>)、いろんなコンテナデプロイして試すにはやっぱりメモリがある程度欲しいよねってことで n1-standard-1 を使うことにした。<br>\nn1-standard-1 だとノードの数が 1 個でもクラスタは起動できるみたい。</p>\n<ol>\n<li>\n<p>クラスタを作成</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ gcloud container clusters create hitochan-cluster \\\n --machine-type<span class=\"token operator\">=</span>n1-standard-1 \\\n --num-nodes<span class=\"token operator\">=</span>1 \\\n --disk-size<span class=\"token operator\">=</span>10 \\\n --no-enable-cloud-logging \\\n --enable-autorepair \\\n --preemptible</code></pre></div>\n</li>\n<li>\n<p>インスタンスグループの一覧を表示して名前をメモしておく。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ gcloud compute instance-groups managed list\nNAME                                            LOCATION       SCOPE  BASE_INSTANCE_NAME                          SIZE  TARGET_SIZE  INSTANCE_TEMPLATE                           AUTOSCALED\ngke-hitochan-cluster-default-pool-6618700a-grp  us-central1-a  zone   gke-hitochan-cluster-default-pool-6618700a  1     1            gke-hitochan-cluster-default-pool-6618700a  no</code></pre></div>\n</li>\n<li>\n<p>2 でメモしたインスタンスグループ名を指定して、インスタンス数を変更する。節約したいので使わないときは 0 にしておく。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ gcloud compute instance-groups managed resize gke-hitochan-cluster-default-pool-6618700a-grp --size<span class=\"token operator\">=</span>0</code></pre></div>\n</li>\n</ol>","frontmatter":{"title":"GKEでクラスタ作るときのメモ","date":"2019-01-15T00:00:00.000Z"},"timeToRead":1}},"pageContext":{"slug":"/2019/01/15/gke-cluster-memo/"}}